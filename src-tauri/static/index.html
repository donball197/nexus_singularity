<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS SINGULARITY v0.2.2</title>
    <style>
        :root { --neon: #00ff41; --dim: #003b00; --bg: #050505; }
        body { background: var(--bg); color: var(--neon); font-family: 'Courier New', monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* Header Sector */
        header { border-bottom: 2px solid var(--neon); padding: 10px 20px; display: flex; justify-content: space-between; background: rgba(0,255,65,0.05); }
        .node-id { text-shadow: 0 0 10px var(--neon); font-weight: bold; }

        /* Main Dashboard Area */
        main { display: grid; grid-template-columns: 1fr 350px; flex-grow: 1; gap: 10px; padding: 10px; }
        
        /* Sector: Micro-Agent Radar */
        #radar-sector { border: 1px solid var(--neon); position: relative; display: flex; flex-direction: column; background: rgba(0, 59, 0, 0.1); }
        #radar-display { flex-grow: 1; padding: 20px; overflow-y: auto; font-size: 0.85rem; line-height: 1.4; scrollbar-width: thin; }
        
        /* Sector: Command Input */
        #input-sector { border: 1px solid var(--neon); padding: 15px; background: #000; }
        input { background: transparent; border: none; border-bottom: 1px solid var(--neon); color: var(--neon); width: 100%; font-family: inherit; font-size: 1.1rem; outline: none; padding: 5px 0; }
        
        /* Pulse Animation Class */
        .pulse-active { animation: scanline 0.2s infinite; border: 2px solid #fff !important; box-shadow: 0 0 20px #fff; }
        @keyframes scanline { 0% { opacity: 0.8; } 50% { opacity: 1; } 100% { opacity: 0.8; } }

        /* Terminal Decor */
        .tag { color: #fff; background: var(--dim); padding: 2px 5px; font-size: 0.7rem; margin-right: 5px; }
    </style>
</head>
<body>
    <header>
        <div>PROJECT NEXUS SINGULARITY <span class="node-id">[NODE: BASE_01_DUET]</span></div>
        <div id="status-clock">DNA: STABLE</div>
    </header>

    <main>
        <section id="radar-sector">
            <div id="radar-display">
                <div style="color: #fff;">> SYSTEM_INIT... SUCCESS</div>
                <div style="color: #fff;">> ONNX_MUSCLES... LOADED</div>
                <div>> AWAITING ARCHITECT COMMAND...</div>
            </div>
        </section>

        <section id="input-sector">
            <div style="font-size: 0.7rem; margin-bottom: 10px;">COMMAND_UPLINK_v0.2.2</div>
            <input type="text" id="terminal-input" placeholder="EXECUTE..." autofocus autocomplete="off">
            <p style="font-size: 0.6rem; color: var(--dim);">[ENTER] to transmit pulse to Gemma 3</p>
        </section>
    </main>

    <script>
        const { invoke } = window.__TAURI__.core;
        const input = document.getElementById('terminal-input');
        const display = document.getElementById('radar-display');
        const sector = document.getElementById('radar-sector');

        async function transmit() {
            const cmd = input.value;
            if (!cmd) return;

            // Log local command
            display.innerHTML += `<div><span class="tag">USER</span> ${cmd}</div>`;
            input.value = '';
            sector.classList.add('pulse-active');

            try {
                // Bridge to Rust Brain
                const response = await invoke("execute_agent_logic", { prompt: cmd });
                display.innerHTML += `<div><span class="tag" style="background:#004400">AGNT</span> ${response}</div>`;
            } catch (err) {
                display.innerHTML += `<div style="color: red;"><span class="tag" style="background:red">ERR</span> ${err}</div>`;
            } finally {
                sector.classList.remove('pulse-active');
                display.scrollTop = display.scrollHeight;
            }
        }

        input.addEventListener('keypress', (e) => { if(e.key === 'Enter') transmit(); });
    </script>
</body>
</html>
